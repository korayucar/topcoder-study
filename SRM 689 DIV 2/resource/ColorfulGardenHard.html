<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>Our garden contains a single row of flowers.
You are given the current contents of the row in the String <b>garden</b>.
Each character in <b>garden</b> represents one flower.
Different characters represent different colors.
Flowers of the same color all look the same.
<br></br>
<br></br>
<br></br>
You may rearrange the flowers in your garden into any order you like.
(Formally, you may swap any two flowers in your garden, and you can do so arbitrarily many times.)
<br></br>
<br></br>
<br></br>
You are also given a String <b>forbid</b> of the same length as <b>garden</b>.
You want to rearrange <b>garden</b> into a new string G that will satisfy the following conditions:
<ul>
<li>No two adjacent flowers will have the same color. Formally, for each valid i, G[i] and G[i+1] must differ.</li>
<li>For each valid i, G[i] must not be equal to <b>forbid</b>[i].</li>
</ul>

Let X be the number of different strings G that satisfy all conditions given above.
Compute and return the number (X modulo 1,000,000,007).</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>ColorfulGardenHard</td></tr><tr><td>Method:</td><td>count</td></tr><tr><td>Parameters:</td><td>String, String</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int count(String garden, String forbid)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>garden</b> will contain between 1 and 15 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element in <b>garden</b> will be a lowercase English letter: 'a'-'z'.</td></tr><tr><td align="center" valign="top">-</td><td><b>garden</b> and <b>forbid</b> will contain the same number of elements.</td></tr><tr><td align="center" valign="top">-</td><td>Each element in <b>forbid</b> will be a lowercase English letter: 'a'-'z'.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>&quot;aaabbb&quot;</pre></td></tr><tr><td><pre>&quot;cccccc&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 2</pre></td></tr><tr><td><table><tr><td colspan="2">There are two solutions: "ababab" and "bababa".</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>&quot;aabbcc&quot;</pre></td></tr><tr><td><pre>&quot;aabbcc&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 5</pre></td></tr><tr><td><table><tr><td colspan="2">We have 5 solutions: "bcacba" "cbacba", "cbacab", "bcacab", "cbcaba".

</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>&quot;aaaabb&quot;</pre></td></tr><tr><td><pre>&quot;xxxxxx&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>&quot;abcdefghijklmno&quot;</pre></td></tr><tr><td><pre>&quot;zzzzzzzzzzzzzzz&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 674358851</pre></td></tr><tr><td><table><tr><td colspan="2">The answer is (15!) % (10^9+7).</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>&quot;a&quot;</pre></td></tr><tr><td><pre>&quot;b&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>